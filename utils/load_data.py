import pandas as pd
import streamlit as st

# Load resume data once
@st.cache_resource
def load_data(path = "", dtype = {}, parse_dates = []):
    """
    Load the data from the specified path
    """
    data = pd.read_csv(
      path,
      compression='gzip',
      dtype=dtype,
      parse_dates=parse_dates
    )
    return data

dtype = {
  'Genero_Usuario': 'category',   
  'Edad_Usuario': 'int64',
  'Ciclo_Estacion_Retiro': 'category',
  'Ciclo_Estacion_Arribo': 'category',
  'Grupo_Edad': 'category',
  'Duracion_Viaje_Minutos': 'float64',
  'Cluster_Retiro': 'category',
  'Cluster_Arribo': 'category'
}

parse_dates = ['Fecha_Hora_Retiro', 'Fecha_Hora_Arribo']

# Load stations data once
@st.cache_resource
def load_stations_data(path = ""):
  """
  Load the stations data from the specified path
  """
  data = pd.read_csv(
    path,
    usecols=['name', 'short_name', 'lat', 'lon', 'cluster'],
    compression='gzip'
  )
  return data


# Most popular routes coordinates
popular_routes_coordinates = {
  "271-272/014": [
    [
        19.443683,
        -99.152446
    ],
    [
        19.442632,
        -99.152514
    ],
    [
        19.442547,
        -99.15252
    ],
    [
        19.442383,
        -99.152533
    ],
    [
        19.442288,
        -99.152541
    ],
    [
        19.440965,
        -99.152658
    ],
    [
        19.440889,
        -99.152674
    ],
    [
        19.440779,
        -99.152711
    ],
    [
        19.440623,
        -99.152762
    ],
    [
        19.440515,
        -99.15279
    ],
    [
        19.440378,
        -99.152817
    ],
    [
        19.440097,
        -99.152931
    ],
    [
        19.439729,
        -99.153075
    ],
    [
        19.439165,
        -99.153288
    ],
    [
        19.439013,
        -99.153346
    ],
    [
        19.438936,
        -99.153375
    ],
    [
        19.438802,
        -99.153427
    ],
    [
        19.438713,
        -99.153462
    ],
    [
        19.437942,
        -99.153757
    ],
    [
        19.437661,
        -99.153859
    ],
    [
        19.43746,
        -99.153932
    ],
    [
        19.437399,
        -99.153954
    ],
    [
        19.437336,
        -99.153978
    ],
    [
        19.436794,
        -99.154183
    ],
    [
        19.43672,
        -99.15421
    ],
    [
        19.436728,
        -99.154266
    ],
    [
        19.43685,
        -99.155187
    ],
    [
        19.436833,
        -99.155329
    ],
    [
        19.43676,
        -99.155435
    ],
    [
        19.436673,
        -99.155487
    ],
    [
        19.43655,
        -99.155538
    ],
    [
        19.436436,
        -99.155569
    ],
    [
        19.436449,
        -99.155669
    ],
    [
        19.436525,
        -99.156283
    ],
    [
        19.436606,
        -99.156909
    ],
    [
        19.436616,
        -99.156981
    ],
    [
        19.436643,
        -99.157154
    ],
    [
        19.436373,
        -99.157271
    ],
    [
        19.435659,
        -99.157582
    ],
    [
        19.435194,
        -99.157785
    ],
    [
        19.43478,
        -99.157966
    ],
    [
        19.434513,
        -99.158082
    ],
    [
        19.434479,
        -99.158097
    ],
    [
        19.434387,
        -99.158137
    ],
    [
        19.434308,
        -99.158172
    ],
    [
        19.43427,
        -99.158189
    ],
    [
        19.432818,
        -99.158835
    ],
    [
        19.432536,
        -99.15896
    ],
    [
        19.43247,
        -99.15899
    ],
    [
        19.432345,
        -99.159045
    ],
    [
        19.432258,
        -99.159088
    ],
    [
        19.432176,
        -99.159127
    ],
    [
        19.431863,
        -99.159278
    ],
    [
        19.43181,
        -99.159302
    ],
    [
        19.431737,
        -99.159338
    ],
    [
        19.431661,
        -99.159375
    ],
    [
        19.431384,
        -99.15951
    ],
    [
        19.431321,
        -99.159538
    ],
    [
        19.431216,
        -99.159592
    ],
    [
        19.430768,
        -99.159819
    ],
    [
        19.430642,
        -99.160076
    ],
    [
        19.42993,
        -99.16159
    ],
    [
        19.429912,
        -99.161628
    ],
    [
        19.429418,
        -99.162679
    ],
    [
        19.429401,
        -99.162714
    ],
    [
        19.429163,
        -99.16322
    ],
    [
        19.429133,
        -99.163284
    ],
    [
        19.429064,
        -99.16343
    ],
    [
        19.42913,
        -99.163499
    ],
    [
        19.429177,
        -99.163584
    ],
    [
        19.4292,
        -99.16368
    ],
    [
        19.429199,
        -99.163778
    ],
    [
        19.429173,
        -99.163878
    ],
    [
        19.429118,
        -99.163967
    ],
    [
        19.429037,
        -99.164039
    ],
    [
        19.42894,
        -99.164083
    ],
    [
        19.428836,
        -99.164093
    ],
    [
        19.428753,
        -99.164075
    ],
    [
        19.428668,
        -99.164257
    ],
    [
        19.428647,
        -99.164301
    ],
    [
        19.428333,
        -99.164971
    ],
    [
        19.428314,
        -99.165011
    ],
    [
        19.428296,
        -99.16505
    ],
    [
        19.42769,
        -99.166342
    ],
    [
        19.427673,
        -99.166379
    ],
    [
        19.427362,
        -99.167042
    ],
    [
        19.427342,
        -99.167084
    ],
    [
        19.427323,
        -99.167126
    ],
    [
        19.42725,
        -99.16728
    ],
    [
        19.427275,
        -99.1673
    ],
    [
        19.42732,
        -99.167345
    ],
    [
        19.42736,
        -99.167396
    ],
    [
        19.427398,
        -99.167466
    ],
    [
        19.427424,
        -99.167541
    ],
    [
        19.427437,
        -99.167619
    ],
    [
        19.427438,
        -99.1677
    ],
    [
        19.427429,
        -99.167768
    ],
    [
        19.427412,
        -99.167828
    ],
    [
        19.427388,
        -99.167885
    ],
    [
        19.427353,
        -99.167944
    ],
    [
        19.427311,
        -99.167997
    ],
    [
        19.427254,
        -99.168048
    ],
    [
        19.427208,
        -99.168078
    ],
    [
        19.427144,
        -99.168109
    ],
    [
        19.427076,
        -99.168128
    ],
    [
        19.427012,
        -99.168135
    ],
    [
        19.426936,
        -99.168131
    ],
    [
        19.426865,
        -99.168114
    ],
    [
        19.426794,
        -99.168263
    ],
    [
        19.426453,
        -99.168979
    ],
    [
        19.426435,
        -99.169017
    ],
    [
        19.425822,
        -99.170306
    ],
    [
        19.425804,
        -99.170344
    ],
    [
        19.42544,
        -99.17111
    ],
    [
        19.425422,
        -99.171147
    ],
    [
        19.425397,
        -99.171199
    ],
    [
        19.425304,
        -99.171394
    ],
    [
        19.425345,
        -99.17143
    ],
    [
        19.425394,
        -99.171512
    ],
    [
        19.425417,
        -99.171606
    ],
    [
        19.425413,
        -99.171655
    ],
    [
        19.42541,
        -99.171703
    ],
    [
        19.425374,
        -99.171793
    ],
    [
        19.425336,
        -99.171839
    ],
    [
        19.42531,
        -99.17187
    ],
    [
        19.425225,
        -99.17192
    ],
    [
        19.425129,
        -99.171937
    ],
    [
        19.425064,
        -99.171925
    ],
    [
        19.424964,
        -99.172136
    ],
    [
        19.424578,
        -99.172952
    ],
    [
        19.424559,
        -99.172992
    ],
    [
        19.424459,
        -99.173204
    ]
],
  "621/618": [
    [
        19.379465,
        -99.140942
    ],
    [
        19.379551,
        -99.141489
    ],
    [
        19.379688,
        -99.142316
    ],
    [
        19.37971,
        -99.142451
    ],
    [
        19.380008,
        -99.142637
    ],
    [
        19.380782,
        -99.143138
    ],
    [
        19.381616,
        -99.143668
    ],
    [
        19.382183,
        -99.144038
    ],
    [
        19.382839,
        -99.144454
    ],
    [
        19.383608,
        -99.144942
    ],
    [
        19.383627,
        -99.1451
    ],
    [
        19.383647,
        -99.145224
    ],
    [
        19.383697,
        -99.145561
    ],
    [
        19.383754,
        -99.145899
    ],
    [
        19.383174,
        -99.146008
    ],
    [
        19.382163,
        -99.146175
    ],
    [
        19.381453,
        -99.146306
    ],
    [
        19.38154,
        -99.146774
    ],
    [
        19.381582,
        -99.146968
    ],
    [
        19.381626,
        -99.1472
    ],
    [
        19.38172,
        -99.147701
    ],
    [
        19.381786,
        -99.148093
    ]
],
  "618/621": [
    [
        19.381786,
        -99.148093
    ],
    [
        19.381815,
        -99.148266
    ],
    [
        19.381477,
        -99.148334
    ],
    [
        19.381018,
        -99.148426
    ],
    [
        19.380915,
        -99.147855
    ],
    [
        19.380782,
        -99.147141
    ],
    [
        19.380654,
        -99.146448
    ],
    [
        19.380539,
        -99.145852
    ],
    [
        19.380402,
        -99.145124
    ],
    [
        19.380279,
        -99.144546
    ],
    [
        19.380168,
        -99.143949
    ],
    [
        19.380969,
        -99.143792
    ],
    [
        19.381435,
        -99.143702
    ],
    [
        19.381616,
        -99.143668
    ],
    [
        19.381734,
        -99.143642
    ],
    [
        19.381617,
        -99.142978
    ],
    [
        19.381535,
        -99.142415
    ],
    [
        19.381423,
        -99.141825
    ],
    [
        19.381251,
        -99.140769
    ],
    [
        19.381133,
        -99.140049
    ],
    [
        19.3807,
        -99.140116
    ],
    [
        19.380061,
        -99.140222
    ],
    [
        19.379632,
        -99.140292
    ],
    [
        19.379369,
        -99.140332
    ],
    [
        19.379385,
        -99.140444
    ],
    [
        19.37944,
        -99.140789
    ],
    [
        19.379457,
        -99.140894
    ],
    [
        19.379465,
        -99.140942
    ]
],
  "014/271-272": [
    [
        19.424459,
        -99.173204
    ],
    [
        19.423958,
        -99.17426
    ],
    [
        19.423939,
        -99.1743
    ],
    [
        19.423519,
        -99.175187
    ],
    [
        19.423472,
        -99.175323
    ],
    [
        19.423435,
        -99.175467
    ],
    [
        19.423413,
        -99.17557
    ],
    [
        19.423402,
        -99.175662
    ],
    [
        19.423395,
        -99.175797
    ],
    [
        19.4234,
        -99.175935
    ],
    [
        19.423432,
        -99.176309
    ],
    [
        19.423486,
        -99.17672
    ],
    [
        19.423595,
        -99.177385
    ],
    [
        19.423666,
        -99.177805
    ],
    [
        19.423671,
        -99.177829
    ],
    [
        19.423835,
        -99.17796
    ],
    [
        19.423889,
        -99.177996
    ],
    [
        19.423914,
        -99.178011
    ],
    [
        19.423953,
        -99.17803
    ],
    [
        19.424006,
        -99.178057
    ],
    [
        19.424119,
        -99.178101
    ],
    [
        19.424846,
        -99.178385
    ],
    [
        19.4249,
        -99.178408
    ],
    [
        19.425025,
        -99.178458
    ],
    [
        19.425053,
        -99.17847
    ],
    [
        19.425314,
        -99.178574
    ],
    [
        19.42674,
        -99.179147
    ],
    [
        19.427743,
        -99.179544
    ],
    [
        19.428274,
        -99.17978
    ],
    [
        19.428517,
        -99.179893
    ],
    [
        19.428598,
        -99.179923
    ],
    [
        19.428666,
        -99.179948
    ],
    [
        19.428738,
        -99.179907
    ],
    [
        19.429073,
        -99.179696
    ],
    [
        19.429498,
        -99.178508
    ],
    [
        19.429685,
        -99.177985
    ],
    [
        19.429578,
        -99.177617
    ],
    [
        19.429308,
        -99.17669
    ],
    [
        19.429357,
        -99.17608
    ],
    [
        19.429423,
        -99.175496
    ],
    [
        19.429456,
        -99.174801
    ],
    [
        19.429686,
        -99.17422
    ],
    [
        19.429611,
        -99.173972
    ],
    [
        19.429593,
        -99.173925
    ],
    [
        19.429465,
        -99.17364
    ],
    [
        19.429449,
        -99.173606
    ],
    [
        19.429431,
        -99.173578
    ],
    [
        19.4294,
        -99.17354
    ],
    [
        19.429365,
        -99.173508
    ],
    [
        19.429315,
        -99.173474
    ],
    [
        19.429277,
        -99.173453
    ],
    [
        19.429233,
        -99.173434
    ],
    [
        19.429173,
        -99.173412
    ],
    [
        19.429133,
        -99.1734
    ],
    [
        19.4291,
        -99.173393
    ],
    [
        19.429062,
        -99.173386
    ],
    [
        19.429025,
        -99.173381
    ],
    [
        19.428986,
        -99.173378
    ],
    [
        19.428672,
        -99.173386
    ],
    [
        19.428522,
        -99.173393
    ],
    [
        19.428462,
        -99.173438
    ],
    [
        19.428424,
        -99.173471
    ],
    [
        19.428405,
        -99.173491
    ],
    [
        19.428384,
        -99.173516
    ],
    [
        19.42836,
        -99.173549
    ],
    [
        19.428347,
        -99.173575
    ],
    [
        19.428334,
        -99.173608
    ],
    [
        19.428325,
        -99.173637
    ],
    [
        19.428321,
        -99.173667
    ],
    [
        19.428319,
        -99.17369
    ],
    [
        19.428319,
        -99.173722
    ],
    [
        19.428323,
        -99.173754
    ],
    [
        19.428328,
        -99.17378
    ],
    [
        19.428336,
        -99.173807
    ],
    [
        19.428346,
        -99.173835
    ],
    [
        19.428356,
        -99.173855
    ],
    [
        19.428371,
        -99.173879
    ],
    [
        19.428388,
        -99.173902
    ],
    [
        19.428416,
        -99.173933
    ],
    [
        19.428441,
        -99.173958
    ],
    [
        19.42846,
        -99.173974
    ],
    [
        19.428486,
        -99.173991
    ],
    [
        19.42851,
        -99.174004
    ],
    [
        19.428531,
        -99.174013
    ],
    [
        19.428555,
        -99.174019
    ],
    [
        19.428581,
        -99.174023
    ],
    [
        19.428611,
        -99.174026
    ],
    [
        19.428644,
        -99.174026
    ],
    [
        19.428681,
        -99.174025
    ],
    [
        19.428954,
        -99.173975
    ],
    [
        19.429421,
        -99.173669
    ],
    [
        19.429894,
        -99.173367
    ],
    [
        19.430624,
        -99.172974
    ],
    [
        19.43072,
        -99.17292
    ],
    [
        19.431129,
        -99.172679
    ],
    [
        19.431299,
        -99.172581
    ],
    [
        19.431406,
        -99.17252
    ],
    [
        19.43222,
        -99.172026
    ],
    [
        19.432914,
        -99.17161
    ],
    [
        19.433315,
        -99.171328
    ],
    [
        19.433757,
        -99.171027
    ],
    [
        19.43399,
        -99.170875
    ],
    [
        19.434604,
        -99.170491
    ],
    [
        19.434809,
        -99.170361
    ],
    [
        19.435066,
        -99.170194
    ],
    [
        19.435775,
        -99.169734
    ],
    [
        19.436122,
        -99.169514
    ],
    [
        19.436054,
        -99.169321
    ],
    [
        19.436001,
        -99.169169
    ],
    [
        19.43595,
        -99.169041
    ],
    [
        19.435893,
        -99.168888
    ],
    [
        19.435818,
        -99.168694
    ],
    [
        19.435605,
        -99.168129
    ],
    [
        19.43545,
        -99.167679
    ],
    [
        19.43547,
        -99.167576
    ],
    [
        19.435338,
        -99.167157
    ],
    [
        19.435316,
        -99.167095
    ],
    [
        19.435298,
        -99.167044
    ],
    [
        19.435043,
        -99.166367
    ],
    [
        19.435012,
        -99.166287
    ],
    [
        19.434855,
        -99.165871
    ],
    [
        19.434791,
        -99.165711
    ],
    [
        19.434528,
        -99.16482
    ],
    [
        19.434228,
        -99.163786
    ],
    [
        19.434203,
        -99.1637
    ],
    [
        19.434038,
        -99.163138
    ],
    [
        19.433806,
        -99.162576
    ],
    [
        19.43355,
        -99.161979
    ],
    [
        19.433082,
        -99.160916
    ],
    [
        19.432881,
        -99.160424
    ],
    [
        19.432702,
        -99.160038
    ],
    [
        19.432669,
        -99.159959
    ],
    [
        19.43261,
        -99.159816
    ],
    [
        19.432357,
        -99.159214
    ],
    [
        19.432352,
        -99.159142
    ],
    [
        19.432345,
        -99.159045
    ],
    [
        19.432463,
        -99.158801
    ],
    [
        19.432572,
        -99.158753
    ],
    [
        19.433017,
        -99.158557
    ],
    [
        19.433918,
        -99.158159
    ],
    [
        19.434179,
        -99.158044
    ],
    [
        19.434202,
        -99.158034
    ],
    [
        19.434287,
        -99.157999
    ],
    [
        19.43437,
        -99.157964
    ],
    [
        19.434455,
        -99.157926
    ],
    [
        19.435128,
        -99.157631
    ],
    [
        19.436034,
        -99.157237
    ],
    [
        19.436322,
        -99.157108
    ],
    [
        19.436438,
        -99.157056
    ],
    [
        19.436616,
        -99.156981
    ],
    [
        19.4367,
        -99.156944
    ],
    [
        19.437713,
        -99.156501
    ],
    [
        19.438114,
        -99.156326
    ],
    [
        19.437975,
        -99.155905
    ],
    [
        19.437773,
        -99.155217
    ],
    [
        19.437399,
        -99.153954
    ],
    [
        19.437367,
        -99.153825
    ],
    [
        19.437427,
        -99.153804
    ],
    [
        19.437914,
        -99.153611
    ],
    [
        19.438663,
        -99.153328
    ],
    [
        19.438759,
        -99.153288
    ],
    [
        19.438824,
        -99.153266
    ],
    [
        19.43888,
        -99.153242
    ],
    [
        19.438897,
        -99.153235
    ],
    [
        19.438962,
        -99.153211
    ],
    [
        19.43936,
        -99.153058
    ],
    [
        19.440057,
        -99.152792
    ],
    [
        19.440342,
        -99.152671
    ],
    [
        19.440473,
        -99.152597
    ],
    [
        19.44058,
        -99.152557
    ],
    [
        19.440734,
        -99.15252
    ],
    [
        19.440839,
        -99.152494
    ],
    [
        19.440942,
        -99.152476
    ],
    [
        19.442258,
        -99.152372
    ],
    [
        19.442357,
        -99.152364
    ],
    [
        19.442521,
        -99.152353
    ],
    [
        19.442606,
        -99.152346
    ],
    [
        19.444109,
        -99.152219
    ],
    [
        19.444176,
        -99.152213
    ],
    [
        19.444185,
        -99.152267
    ],
    [
        19.444199,
        -99.152346
    ],
    [
        19.444211,
        -99.152411
    ],
    [
        19.444141,
        -99.152416
    ],
    [
        19.443683,
        -99.152446
    ]
],
  "494/486": [
    [
        19.444031,
        -99.167389
    ],
    [
        19.443348,
        -99.167809
    ],
    [
        19.442329,
        -99.168454
    ],
    [
        19.441291,
        -99.169089
    ],
    [
        19.440251,
        -99.169734
    ],
    [
        19.439233,
        -99.170391
    ],
    [
        19.438181,
        -99.171035
    ],
    [
        19.43779,
        -99.170331
    ],
    [
        19.437354,
        -99.16956
    ]
]
}


